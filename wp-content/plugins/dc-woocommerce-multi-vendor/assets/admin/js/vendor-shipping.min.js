!function(t,e,i,s){t(function(){var i=i||{build:function(){this.init(),this.bindEvents()},init:function(){this.table_shipping_zone_settings=".wcmp-shipping-zone-settings",this.table_shipping_zone_methods=".wcmp-shipping-zone-methods",this.modify_shipping_methods=".modify-shipping-methods",this.modal_add_shipping_method=".wcmp-modal-add-shipping-method-modal",this.show_shipping_methods=this.table_shipping_zone_settings+" .wcmp-shipping-zone-show-method",this.add_shipping_methods=this.modal_add_shipping_method+" .wcmp-shipping-zone-add-method",this.edit_shipping_methods=this.table_shipping_zone_settings+" .edit-shipping-method",this.delete_shipping_method=this.table_shipping_zone_settings+" .delete-shipping-method",this.method_status=this.table_shipping_zone_methods+" .method-status",this.limit_zone_location=this.table_shipping_zone_settings+" #limit_zone_location"},bindEvents:function(){t(document.body).on("click",this.show_shipping_methods,this.showShippingMethods),t(document.body).on("wc_backbone_modal_response",this.addShippingMethod),t(document.body).on("wc_backbone_modal_response",this.updateShippingMethod),t(document.body).on("click",this.edit_shipping_methods,this.editShippingMethod),t(document.body).on("click",this.delete_shipping_method,this.deleteShippingMethod),t(document.body).on("change",this.method_status,this.toggleShippingMethod),t(document.body).on("change",this.limit_zone_location,this.limitZoneLocation),t(document.body).on("change",".wc-shipping-zone-method-selector select",this.onChangeShippingMethodSelector),this.limitZoneLocation()},showShippingMethods:function(e){e.preventDefault();var i=t("#zone_id").val();t(this).WCBackboneModal({template:"wcmp-modal-add-shipping-method",variable:{zone_id:i}}),t(".wc-shipping-zone-method-selector select").change()},onChangeShippingMethodSelector:function(){var e=t(this).find("option:selected").data("description");t(this).parent().find(".wc-shipping-zone-method-description").remove(),t(this).after('<div class="wc-shipping-zone-method-description">'+e+"</div>"),t(this).closest("article").height(t(this).parent().height())},addShippingMethod:function(e,i,n){if("wcmp-modal-add-shipping-method"===i){e.preventDefault();var o=n.zone_id,d=n.wcmp_shipping_method;if(""==o);else if(""==d);else{var a={action:"wcmp-add-shipping-method",zoneID:o,method:d};t(this.add_shipping_methods).block({message:null,overlayCSS:{background:"#fff",opacity:.6}});t.ajax({method:"post",url:s,data:a,success:function(t){t.success&&location.reload()}})}}},editShippingMethod:function(e){e.preventDefault(),t(".wcmp-shipping-zone-methods").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var i=t(e.currentTarget).data("instance_id"),n=t(e.currentTarget).data("method_id"),o={action:"wcmp-configure-shipping-method",zoneId:t(e.currentTarget).data("zone_id"),instanceId:i,methodId:n};t("#method_id_selected").val(n),t("#instance_id_selected").val(i);t.ajax({method:"post",url:s,data:o,success:function(e){e&&(t(".wcmp-shipping-zone-methods").unblock(),t(this).WCBackboneModal({template:"wcmp-modal-update-shipping-method",variable:{methodId:n,instanceId:i,config_settings:e}}))}})},updateShippingMethod:function(e,i,n){if("wcmp-modal-update-shipping-method"===i){e.preventDefault();var o=n.method_id,d=n.instance_id,a=n.zone_id,h={action:"wcmp-update-shipping-method",zoneID:a,posted_data:n,args:{instance_id:d,zone_id:a,method_id:o,settings:{}}};"free_shipping"==o&&(h.args.settings.title=n.method_title,h.args.settings.description=n.method_description,h.args.settings.cost=0,h.args.settings.tax_status="none",h.args.settings.min_amount=n.minimum_order_amount),"local_pickup"==o&&(h.args.settings.title=n.method_title,h.args.settings.description=n.method_description,h.args.settings.cost=n.method_cost,h.args.settings.tax_status=n.method_tax_status),"flat_rate"==o&&(h.args.settings.title=n.method_title,h.args.settings.description=n.method_description,h.args.settings.cost=n.method_cost,h.args.settings.tax_status=n.method_tax_status,h.args.settings["class_cost_"+n.shipping_class_id]=n.shipping_class_cost,h.args.settings.calculation_type=n.calculation_type);t.ajax({method:"post",url:s,data:h,success:function(t){t.success?location.reload():alert(resp.data)}})}},deleteShippingMethod:function(i){i.preventDefault();if(confirm(e.i18n.deleteShippingMethodConfirmation)){t(i.target).is(this.delete_shipping_method)?i.target:t(i.target).closest(this.delete_shipping_method);var n=t(i.target).attr("data-instance_id"),o=t("#zone_id").val(),d=d={action:"wcmp-delete-shipping-method",zoneID:o,instance_id:n};if(""==o);else if(""==n);else t.ajax({method:"post",url:s,data:d,success:function(t){t.success?location.reload():alert(resp.data)}})}},limitZoneLocation:function(e){t("#limit_zone_location").is(":checked")?t(".hide_if_zone_not_limited").show():t(".hide_if_zone_not_limited").hide()},toggleShippingMethod:function(e){e.preventDefault();var i=t(e.target).is(":checked"),s=t(e.target).val(),n=t("#zone_id").val(),o={action:"wcmp-toggle-shipping-method",zoneID:n,instance_id:s,checked:i};if(""==n);else if(""==s);else{t(".wcmp-container").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});t.ajax({method:"post",url:wcmp_vendor_shipping_script_data.ajaxurl,data:o,success:function(e){e.success?t(".wcmp-container").unblock():(t(".wcmp-container").unblock(),alert(e.data))}})}}};t(i.build.bind(i))})}(jQuery,wcmp_vendor_shipping_script_data,wp,ajaxurl);